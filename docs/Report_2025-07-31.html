<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ManLab Regular Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:target {
            background-color: #ffff99;
            transition : background-color 0.3s ease;
        }
        tr.highlight {
            background-color: #ffff99;
        }
        h1 {
            text-align: center;
        }
        canvas {
            display: block;
            margin: 0 auto;
        }
        hr {
            height : 50px;
            border : 0;
        }
        .chart-row {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }
        .chart-box {
            flex: 1 1 30%;
            max-width: 400px;
        }            
    </style>
</head>
<body>
<h1 style="text-align: center;">ManLab Regular Security Report</h1>
<p style="text-align: right;">Report period: 2025-07-30 22:31:31 ~ 2025-07-31 22:31:31</p>

<hr/>
<h1>📂 File Integrity Monitoring Report</h1>

<h2>• Modified Files (Manual Scan Results)</h2>
<div style="display: flex; justify-content: space-between; gap: 20px; flex-wrap: wrap;">
    <!-- 확장자별 차트 + 범례 -->
    <div style="display: flex; align-items: center;">
        <canvas id="manualScanExtChart" width="400" height="400"></canvas>
        <div id="manualScanExtLegend" style="margin-left: 20px;"></div>
    </div>

    <!-- 변경 사유별 차트 -->
    <div>
        <canvas id="manualScanReasonChart" width="400" height="400"></canvas>
    </div>

    <!-- 시간대별 차트 -->
    <div>
        <canvas id="manualScanTimeChart" width="400" height="400"></canvas>
    </div>
</div>

<table id = "manualScanTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Path</th>
            <th>Current MD5 Hash</th>
            <th>Permission</th>
            <th>UID</th>
            <th>GID</th>
            <th>CTime</th>
            <th>MTime</th>
            <th>Size</th>
        </tr>
    </thead>
    <tbody>
<tr><td>1</td><td>/etc/audit/rules.d/manlab.rules</td><td data-changed="false">876618cf387096c220dda9153a82674b</td><td data-changed="false">rw-r-----</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 14:06:12</td><td data-changed="true">2025-07-31 14:06:12</td><td data-changed="false">1241</td></tr>
<tr><td>2</td><td>/etc/rsyslog.d/50-manlab.conf</td><td data-changed="false">82b0b46e3cda59358689540940a8940a</td><td data-changed="false">rw-r--r--</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="false">166</td></tr>
<tr><td>3</td><td>/etc/resolv.conf</td><td data-changed="false">fbfde622ae28a4dcfbf73a397a10c6ae</td><td data-changed="false">rw-r--r--</td><td data-changed="false">101</td><td data-changed="false">103</td><td data-changed="true">2025-07-31 22:21:44</td><td data-changed="true">2025-07-31 22:21:44</td><td data-changed="false">717</td></tr>
<tr><td>4</td><td>/etc/mtab</td><td data-changed="true">4d4ae1ffdcd868ce86d0121d543d2c17</td><td data-changed="false">r--r--r--</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 22:30:23</td><td data-changed="true">2025-07-31 22:30:23</td><td data-changed="false">0</td></tr>
<tr><td>5</td><td>/etc/systemd/system/multi-user.target.wants/manlab-init.service</td><td data-changed="false">ee4dc95e2db434c0ddf2f7e8e4884a72</td><td data-changed="false">rw-r--r--</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="false">190</td></tr>
<tr><td>6</td><td>/etc/systemd/system/manlab-init.service</td><td data-changed="false">ee4dc95e2db434c0ddf2f7e8e4884a72</td><td data-changed="false">rw-r--r--</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="true">2025-07-31 14:06:08</td><td data-changed="false">190</td></tr>
<tr><td>7</td><td>/etc/cups/subscriptions.conf</td><td data-changed="true">b438a655936af9ee07d36ffc089ea6a5</td><td data-changed="false">rw-r-----</td><td data-changed="false">0</td><td data-changed="false">7</td><td data-changed="true">2025-07-31 22:29:01</td><td data-changed="true">2025-07-31 22:29:01</td><td data-changed="true">2436</td></tr>
<tr><td>8</td><td>/etc/cups/subscriptions.conf.O</td><td data-changed="true">a143fabaf07adcfcad8f4f4c98640880</td><td data-changed="false">rw-r-----</td><td data-changed="false">0</td><td data-changed="false">7</td><td data-changed="true">2025-07-31 22:29:01</td><td data-changed="true">2025-07-31 22:22:19</td><td data-changed="true">2435</td></tr>
<tr><td>9</td><td>/etc/printcap</td><td data-changed="false">ebb5375075e20463db8dfa96763390af</td><td data-changed="false">rw-r--r--</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 22:21:46</td><td data-changed="true">2025-07-31 22:21:46</td><td data-changed="false">135</td></tr>
<tr><td>10</td><td>/etc/test.txt</td><td data-changed="true">4c850c5b3b2756e67a91bad8e046ddac</td><td data-changed="false">rwxrwxrwx</td><td data-changed="false">0</td><td data-changed="false">0</td><td data-changed="true">2025-07-31 01:14:06</td><td data-changed="true">2025-07-31 01:14:06</td><td data-changed="true">6</td></tr>
</tbody></table>
<h2>• Real-time Monitoring Events</h2>
<div style="display: flex; justify-content: center;">
    <canvas id="realtimeChart" style="margin-right: 10px;" width="400" height="400"></canvas>
    <canvas id="realtimeTimeChart" width="400" height="400"></canvas>
</div>
<table id = "realtimeTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Path</th>
            <th>Event Type</th>
            <th>New Name</th>
            <th>Timestamp</th>
        </tr>
    </thead>
    <tbody>
<tr><td>1</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>2</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>3</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>4</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>5</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>6</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>7</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>8</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>9</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>10</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>11</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>12</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>13</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>14</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>15</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>16</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>17</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>18</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>19</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>20</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>21</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>22</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>23</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>24</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>25</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>26</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>27</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>28</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>29</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>30</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>31</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>32</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>33</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>34</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>35</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>36</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>37</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>38</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>39</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>40</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>41</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>42</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>43</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>44</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>45</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>46</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>47</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>48</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>49</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>50</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>51</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>52</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>53</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>54</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>55</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>56</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>57</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>58</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>59</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>60</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>61</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>62</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>63</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>64</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>65</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>66</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>67</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>68</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>69</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>70</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>71</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>72</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>73</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>74</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>75</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>76</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>77</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>78</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>79</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>80</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>81</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>82</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>83</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>84</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>85</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>86</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>87</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>88</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>89</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>90</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>91</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>92</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>93</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>94</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>95</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>96</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>97</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>98</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>99</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>100</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>101</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>102</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>103</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>104</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>105</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>106</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>107</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>108</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>109</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:35.260</td></tr><tr><td>110</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:41.777</td></tr><tr><td>111</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-30 23:27:58.147</td></tr><tr><td>112</td><td>/etc/b.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>113</td><td>/etc/b.txt</td><td>CREATE         </td><td>-</td><td>2025-07-31 00:35:50.247</td></tr><tr><td>114</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:36:52.550</td></tr><tr><td>115</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:04.419</td></tr><tr><td>116</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 00:37:13.269</td></tr><tr><td>117</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 00:37:13.270</td></tr><tr><td>118</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:07:41.078</td></tr><tr><td>119</td><td>/etc/test.txt</td><td>MODIFY         </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr><tr><td>120</td><td>/etc/test.txt</td><td>ATTRIB CHANGE  </td><td>-</td><td>2025-07-31 01:14:07.014</td></tr></tbody></table>
<script>

function highlightManualRowByExt(ext) {
    document.querySelectorAll('#manualScanTable tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
        const pathCell = tr.querySelector('td:nth-child(2)');
        if (pathCell && pathCell.textContent.trim().endsWith('.' + ext)) {
            tr.classList.add('highlight');
        }
    });
}

function highlightManualRowByReason(reason) {
    const reasonColMap = {
        "해시값 변경": 3,
        "권한 변경": 4,
        "UID 변경": 5,
        "GID 변경": 6,
        "CTime 변경": 7,
        "MTime 변경": 8,
        "크기 변경": 9
    };
    const colIdx = reasonColMap[reason];

    document.querySelectorAll('#manualScanTable tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
        const td = tr.querySelector(`td:nth-child(${colIdx})`);
        if (td && td.dataset.changed === "true") {
            tr.classList.add('highlight');
        }
    });
}

function highlightManualRowByTime(timeLabel) {
    const startTime = new Date(timeLabel.replace(" ", "T") + ":00");
    const endTime = new Date(startTime.getTime() + 3 * 60 * 60 * 1000);

    document.querySelectorAll('#manualScanTable tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
        const mtimeCell = tr.querySelector('td:nth-child(8)');
        if (mtimeCell) {
            const mtime = new Date(mtimeCell.textContent.trim().replace(" ", "T"));
            if (mtime >= startTime && mtime < endTime) {
                tr.classList.add('highlight');
            }
        }
    });
}

function highlightRealtimeRowByType(type) {
    const target = type.trim().toLowerCase();

    document.querySelectorAll('#realtimeTable tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
        const td = tr.querySelector('td:nth-child(3)');
        if (td && td.textContent.trim().toLowerCase() === target) {
            tr.classList.add('highlight');
        }
    });

    const first = document.querySelector('#realtimeTable tbody tr.highlight');
    if (first) first.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function highlightRealtimeRowByTime(label) {
    const startTime = new Date(label.replace(" ", "T") + ":00");
    const endTime = new Date(startTime.getTime() + 3 * 60 * 60 * 1000);

    document.querySelectorAll('#realtimeTable tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
        const td = tr.querySelector('td:nth-child(5)');
        if (td) {
            const eventTime = new Date(td.textContent.trim().replace(" ", "T"));
            if (eventTime >= startTime && eventTime < endTime) {
                tr.classList.add('highlight');
            }
        }
    });

    const first = document.querySelector('#realtimeTable tbody tr.highlight');
    if (first) first.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// File Extension 도넛
const extCtx = document.getElementById('manualScanExtChart').getContext('2d');
const extChart = new Chart(extCtx, {
    type: 'doughnut',
    data: {
        labels: ["/etc/mtab", "/etc/printcap", "O", "conf", "rules", "service", "txt"],
        datasets: [{
            data: [1, 1, 1, 3, 1, 2, 1],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)", "rgba(44, 224, 148, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        onClick: (evt) => {
            const points = extChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const label = extChart.data.labels[points[0].index];
                highlightManualRowByExt(label);
            }
        },
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            },
            title: {
                display: true,
                text: "File Extension",
                font: {size: 18, weight: 'bold' }
            }
        }
    },
    plugins: [ChartDataLabels] 
});

//도넛 요약 차트 표

(function() {
    const data = extChart.data;
    const total = data.datasets[0].data.reduce((sum, v) => sum + v, 0);
    let htmlLegend = '<table style="border-collapse: collapse; text-align: right;">';
    data.labels.forEach((label, i) => {
        const count = data.datasets[0].data[i];
        const pct   = ((count/total)*100).toFixed(2) + '%';
        const color = data.datasets[0].backgroundColor[i];
        htmlLegend += `
            <tr>
              <td style="padding:4px;">
                <span style="display:inline-block;width:12px;height:12px;
                          background-color:${color};margin-right:8px;"></span>
                ${label}
              </td>
              <td style="padding:4px;">${count}</td>
              <td style="padding:4px;">${pct}</td>
            </tr>`;
    });
    htmlLegend += '</table>';
    document.getElementById('manualScanExtLegend').innerHTML = htmlLegend;
})();

//File Change Reasons 막대 그래프
const reasonCtx = document.getElementById('manualScanReasonChart').getContext('2d');
const reasonChart = new Chart(reasonCtx, {
    type: 'bar',
    data: {
        labels: ["CTime 변경", "MTime 변경", "크기 변경", "해시값 변경"],
        datasets: [{
            label: '변경된 파일 수',
            data: [10, 10, 3, 4],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        onClick: (evt) => {
            const points = reasonChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const label = reasonChart.data.labels[points[0].index];
                highlightManualRowByReason(label);
            }
        },

        plugins: {
            legend: { display: false },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (value) => value
            },
            title: {
                display: true,
                text: "File Change Reasons",
                font: {size: 18, weight: 'bold' },
                padding: { bottom : 20}
            }
        },
        scales: {
            y:{
                beginAtZero: true,
                ticks:{
                    stepSize: 1,
                    precision: 0
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});

//Modification By Time
const timeCtx = document.getElementById('manualScanTimeChart').getContext('2d');
    const timeChart = new Chart(timeCtx, {
        type: 'bar',
        data: {
            labels: ["2025-07-30 21:00", "2025-07-31 00:00", "2025-07-31 03:00", "2025-07-31 06:00", "2025-07-31 09:00", "2025-07-31 12:00", "2025-07-31 15:00", "2025-07-31 18:00", "2025-07-31 21:00"],
        datasets: [{
            label: '이벤트 수',
            data: [0, 1, 0, 0, 0, 4, 0, 0, 5],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)", "rgba(44, 224, 148, 0.6)", "rgba(94, 48, 2, 0.6)", "rgba(144, 128, 112, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        onClick: (evt) => {
            const points = timeChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const label = timeChart.data.labels[points[0].index];
                highlightManualRowByTime(label);
            }
        },
        plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: ' Modification By Time',
                font: {size: 18, weight: 'bold' }
            },
            datalabels: {
                color: '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (v) => v
            }
        },
        scales: {
            x: {
                grid: { display: true, drawBorder: true },
                ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 },
                title : {
                    display : false,
                    text : 'Time Interval (3hours)',
                    font: {
                        size : 13,
                        weight: 'bold'
                    },
                    padding: {top : 10},
                }
            },
            y: {
                beginAtZero: true,
                grid: { display: true },
                title: {
                    display: false,
                    text: 'Number of Events',
                    font: {
                        size: 13,
                        weight: 'bold'
                    },
                    padding: { bottom: 10 },
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});

//Events By Type 막대 그래프
const rtCtx = document.getElementById('realtimeChart').getContext('2d');
const rtChart = new Chart(rtCtx, {
    type: 'bar',
    data: {
        labels: ["ATTRIB CHANGE  ", "CREATE         ", "MODIFY         "],
        datasets: [{
            label: 'Event Count',
            data: [90, 10, 20],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        onClick: (evt) => {
            const points = rtChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const label = rtChart.data.labels[points[0].index];
                highlightRealtimeRowByType(label);
            }
        },
        plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: ' Events By Type',
                font: {size: 18, weight: 'bold' }
            },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            }
        },
        scales: {
            y:{
                beginAtZero: true,
                ticks:{
                    stepSize: 1,
                    precision: 0
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});

//Events by Time 시간 막대 그래프
const rtTimeCtx = document.getElementById('realtimeTimeChart').getContext('2d');
const rtTimeChart = new Chart(rtTimeCtx, {
    type: 'bar',
    data: {
        labels: ["2025-07-30 21:00", "2025-07-31 00:00", "2025-07-31 03:00", "2025-07-31 06:00", "2025-07-31 09:00", "2025-07-31 12:00", "2025-07-31 15:00", "2025-07-31 18:00", "2025-07-31 21:00"],
        datasets: [{
            label: 'Events By Time',
            data: [30, 90, 0, 0, 0, 0, 0, 0, 0],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)", "rgba(44, 224, 148, 0.6)", "rgba(94, 48, 2, 0.6)", "rgba(144, 128, 112, 0.6)"
            ]
        }]
    },
    options: {
        responsive: false,
        onClick: (evt) => {
            const points = rtTimeChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const label = rtTimeChart.data.labels[points[0].index];
                highlightRealtimeRowByTime(label);
            }
        },
        plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: 'Events by Time',
                font: {size: 18, weight: 'bold' }
            },
            datalabels: {
                color: '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (value) => value
            }
        },
        scales: {
            x: {
                grid: { display: true, drawBorder: true },
                ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 },
                title : {
                    display : false,
                    text : 'Time Interval (3hours)',
                    font: {
                        size : 13,
                        weight: 'bold'
                    },
                    padding: {top : 10},
                }
            },
            y: {
                beginAtZero: true,
                grid: { display: true },
                title: {
                    display: false,
                    text: 'Number of Events',
                    font: {
                        size: 13,
                        weight: 'bold'
                    },
                    padding: { bottom: 10 },
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

<hr/>
<h1>🔍 Malware Scan Report</h1>
<h2>• Malware Scan Detection Overview</h2>
<canvas id="malwareScanDonutChart" width="400" height="400"></canvas>

<h2>• Scan Details</h2>
<table>
    <thead>
        <tr>
            <th>Date</th>
            <th>ID</th>
            <th>File Path</th>
            <th>File Name</th>
            <th>Reason</th>
            <th>Malware Name / Rule</th>
            <th>Quarantine Success Status</th>
        </tr>
    </thead>
    <tbody>
<tr>
            <td colspan="7" style="text-align: center; font-style: italic;">
            No quarantined files found during this period.
            </td>
        </tr>
    </tbody>
</table>

<script>
const scanCtx = document.getElementById('malwareScanDonutChart').getContext('2d');
new Chart(scanCtx, {
    type: 'doughnut',
    data: {
        labels: ['Detected', 'Not Detected'],
        datasets: [{
            data: [0, 0],
            backgroundColor: [
                'rgba(255, 99, 132, 0.6)', // Detected (Red)
                'rgba(75, 192, 192, 0.6)'  // Not Detected (Cyan)
            ]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

<hr/>
<h1>📜Malicious Behavior Report</h1>

<h2>• Malicious Behavior Overview</h2>
<div class="chart-row">
    <div class="chart-box">
        <canvas id="typeDonutChart" width="400" height="400"></canvas>
    </div>
    <div class="chart-box">
        <canvas id="userBarChart" width="400" height="400"></canvas>
    </div>
    <div class="chart-box">
        <canvas id="timeHistogram" width="400" height="400"></canvas>
    </div>
</div>

<h2>• Detected Malicious Behavior Details</h2>
<table id="LogDetailTable">
    <thead>
        <tr>
            <th>Event ID</th>
            <th>Type</th>
            <th>Description</th>
            <th>Timestamp</th>
            <th>Username</th>
            <th>Original Log Path</th>
        </tr>
    </thead>
    <tbody>
<tr><td><a href="#raw-1">1</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-30 23:25:42</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-2">2</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-30 23:25:49</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-3">3</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /etc/test.txt</td><td>2025-07-30 23:27:03</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-4">4</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/chmod 777 /etc/test.txt</td><td>2025-07-30 23:27:35</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-5">5</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /etc/test.txt</td><td>2025-07-30 23:27:38</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-6">6</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/chown 1000:1000 /etc/test.txt</td><td>2025-07-30 23:27:58</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-7">7</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-30 23:28:19</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-8">8</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-31 00:32:38</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-9">9</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td><td>2025-07-31 00:33:13</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-10">10</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/touch /etc/b.txt</td><td>2025-07-31 00:35:50</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-11">11</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/chown 0:0 /etc/test.txt</td><td>2025-07-31 00:36:52</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-12">12</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/chmod 777 /etc/test.txt</td><td>2025-07-31 00:37:04</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-13">13</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /etc/test.txt</td><td>2025-07-31 00:37:09</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-14">14</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/rm /etc/y.txt</td><td>2025-07-31 00:37:37</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-15">15</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi ReportConfig.ini</td><td>2025-07-31 00:38:43</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-16">16</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi ReportConfig.ini</td><td>2025-07-31 00:42:28</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-17">17</a></td><td>T1548</td><td>권한 상승 시도(파일 소유자 또는 그룹 변경)</td><td>2025-07-31 00:51:52</td><td></td><td>/var/log/audit/audit.log</td></tr>
<tr><td><a href="#raw-18">18</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-31 00:54:32</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-19">19</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /conf/ReportConf.ini</td><td>2025-07-31 00:54:58</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-20">20</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /conf/ReportConfig.ini</td><td>2025-07-31 00:55:24</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-21">21</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 00:56:03</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-22">22</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td><td>2025-07-31 01:00:25</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-23">23</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td><td>2025-07-31 01:02:34</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-24">24</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td><td>2025-07-31 01:03:32</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-25">25</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/touch /home/l.txt</td><td>2025-07-31 01:04:03</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-26">26</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td><td>2025-07-31 01:04:22</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-27">27</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /etc/test.txt</td><td>2025-07-31 01:07:37</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-28">28</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 01:08:21</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-29">29</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-31 01:11:02</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-30">30</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 01:11:18</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-31">31</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab baseline</td><td>2025-07-31 01:11:49</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-32">32</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /etc/test.txt</td><td>2025-07-31 01:14:04</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-33">33</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 01:14:21</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-34">34</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 01:16:08</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-35">35</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 01:16:16</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-36">36</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 01:34:16</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-37">37</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 01:39:27</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-38">38</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 01:39:39</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-39">39</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 02:06:24</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-40">40</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 02:06:34</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-41">41</a></td><td>T1059</td><td>/tmp 디렉터리 내 파일 실행</td><td>2025-07-31 02:11:55</td><td>yeji</td><td>/var/log/audit/audit.log</td></tr>
<tr><td><a href="#raw-42">42</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi ReportConfig.ini</td><td>2025-07-31 02:24:51</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-43">43</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 02:28:53</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-44">44</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /conf/ReportConfig.ini</td><td>2025-07-31 02:29:09</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-45">45</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 02:29:25</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-46">46</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 02:37:55</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-47">47</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 02:38:01</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-48">48</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 02:54:08</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-49">49</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 02:54:15</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-50">50</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 14:06:25</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-51">51</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 14:06:47</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-52">52</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/local/bin/ManLab integscan</td><td>2025-07-31 22:30:18</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-53">53</a></td><td>T1548.003</td><td>비인가 사용자 yeji가 sudo 명령 사용 : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-31 22:30:49</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
</tbody>
</table>

<h2>• Event Log Line by ID</h2>
<table>
    <thead>
        <tr>
            <th>Event ID</th>
            <th>Raw Log Line</th>
        </tr>
    </thead>
    <tbody>
<tr id="raw-1"><td>1</td><td>2025-07-30T23:25:42.186272+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-2"><td>2</td><td>2025-07-30T23:25:49.737185+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-3"><td>3</td><td>2025-07-30T23:27:03.992125+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-4"><td>4</td><td>2025-07-30T23:27:35.243641+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/chmod 777 /etc/test.txt</td></tr>
<tr id="raw-5"><td>5</td><td>2025-07-30T23:27:38.997715+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-6"><td>6</td><td>2025-07-30T23:27:58.014255+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/chown 1000:1000 /etc/test.txt</td></tr>
<tr id="raw-7"><td>7</td><td>2025-07-30T23:28:19.388971+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-8"><td>8</td><td>2025-07-31T00:32:38.322493+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-9"><td>9</td><td>2025-07-31T00:33:13.184044+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td></tr>
<tr id="raw-10"><td>10</td><td>2025-07-31T00:35:50.199466+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/touch /etc/b.txt</td></tr>
<tr id="raw-11"><td>11</td><td>2025-07-31T00:36:52.484096+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/chown 0:0 /etc/test.txt</td></tr>
<tr id="raw-12"><td>12</td><td>2025-07-31T00:37:04.367653+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/chmod 777 /etc/test.txt</td></tr>
<tr id="raw-13"><td>13</td><td>2025-07-31T00:37:09.332481+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-14"><td>14</td><td>2025-07-31T00:37:37.251175+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/rm /etc/y.txt</td></tr>
<tr id="raw-15"><td>15</td><td>2025-07-31T00:38:43.040810+09:00 ubuntu20 sudo:     yeji : TTY=pts/5 ; PWD=/home/yeji/manlab/ManLab/conf ; USER=root ; COMMAND=/usr/bin/vi ReportConfig.ini</td></tr>
<tr id="raw-16"><td>16</td><td>2025-07-31T00:42:28.710060+09:00 ubuntu20 sudo:     yeji : TTY=pts/5 ; PWD=/home/yeji/manlab/ManLab/conf ; USER=root ; COMMAND=/usr/bin/vi ReportConfig.ini</td></tr>
<tr id="raw-17"><td>17</td><td>type=SYSCALL msg=audit(1753890712.044:841): arch=c000003e syscall=260 success=yes exit=0 a0=ffffff9c a1=565329fcb220 a2=ffffffff a3=4 items=1 ppid=1 pid=1118 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm="chgrp" exe="/usr/bin/chgrp" subj=unconfined key="owner_changes"</td></tr>
<tr id="raw-18"><td>18</td><td>2025-07-31T00:54:32.011896+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-19"><td>19</td><td>2025-07-31T00:54:58.107508+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /conf/ReportConf.ini</td></tr>
<tr id="raw-20"><td>20</td><td>2025-07-31T00:55:24.374272+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /conf/ReportConfig.ini</td></tr>
<tr id="raw-21"><td>21</td><td>2025-07-31T00:56:03.204332+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-22"><td>22</td><td>2025-07-31T01:00:25.643293+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td></tr>
<tr id="raw-23"><td>23</td><td>2025-07-31T01:02:34.744810+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td></tr>
<tr id="raw-24"><td>24</td><td>2025-07-31T01:03:32.064698+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td></tr>
<tr id="raw-25"><td>25</td><td>2025-07-31T01:04:03.133815+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/touch /home/l.txt</td></tr>
<tr id="raw-26"><td>26</td><td>2025-07-31T01:04:22.011419+09:00 ubuntu20 sudo:     yeji : TTY=pts/1 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/sqlite3 /root/ManLab/db/realtimemonitor.db</td></tr>
<tr id="raw-27"><td>27</td><td>2025-07-31T01:07:37.437234+09:00 ubuntu20 sudo:     yeji : TTY=pts/3 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-28"><td>28</td><td>2025-07-31T01:08:21.605394+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-29"><td>29</td><td>2025-07-31T01:11:02.155752+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-30"><td>30</td><td>2025-07-31T01:11:18.601380+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-31"><td>31</td><td>2025-07-31T01:11:49.851867+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/local/bin/ManLab baseline</td></tr>
<tr id="raw-32"><td>32</td><td>2025-07-31T01:14:04.255136+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-33"><td>33</td><td>2025-07-31T01:14:21.928470+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-34"><td>34</td><td>2025-07-31T01:16:08.187821+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-35"><td>35</td><td>2025-07-31T01:16:16.141090+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-36"><td>36</td><td>2025-07-31T01:34:16.823957+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-37"><td>37</td><td>2025-07-31T01:39:27.425133+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-38"><td>38</td><td>2025-07-31T01:39:39.552993+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-39"><td>39</td><td>2025-07-31T02:06:24.329582+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-40"><td>40</td><td>2025-07-31T02:06:34.021137+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-41"><td>41</td><td>type=SYSCALL msg=audit(1753895515.923:906): arch=c000003e syscall=59 success=yes exit=0 a0=55595ace95d8 a1=55595ace95a0 a2=55595ace95c0 a3=7f627f302850 items=2 ppid=1410 pid=1452 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=2 comm="mv" exe="/usr/bin/mv" subj=unconfined key="usb_file_access"</td></tr>
<tr id="raw-42"><td>42</td><td>2025-07-31T02:24:51.342507+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab/conf ; USER=root ; COMMAND=/usr/bin/vi ReportConfig.ini</td></tr>
<tr id="raw-43"><td>43</td><td>2025-07-31T02:28:53.776527+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-44"><td>44</td><td>2025-07-31T02:29:09.504902+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /conf/ReportConfig.ini</td></tr>
<tr id="raw-45"><td>45</td><td>2025-07-31T02:29:25.593606+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-46"><td>46</td><td>2025-07-31T02:37:55.943794+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-47"><td>47</td><td>2025-07-31T02:38:01.180823+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-48"><td>48</td><td>2025-07-31T02:54:08.643280+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-49"><td>49</td><td>2025-07-31T02:54:15.453282+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-50"><td>50</td><td>2025-07-31T14:06:25.292650+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-51"><td>51</td><td>2025-07-31T14:06:47.734663+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-52"><td>52</td><td>2025-07-31T22:30:18.911329+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-53"><td>53</td><td>2025-07-31T22:30:49.749165+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
</tbody>
</table>

<script>
function highlightRowType(type) {
    console.log("highlightRow called with type:", type);

    document.querySelectorAll('table tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
    });

    document.querySelectorAll('#LogDetailTable tbody tr').forEach(tr => {
        const td = tr.querySelector('td:nth-child(2)');
        if (td) {
            const cellText = td.textContent.trim();
            if (cellText === type) {
                tr.classList.add('highlight');
            }
        }
    });

    const firstHighlighted = document.querySelector('#LogDetailTable tbody tr.highlight');
    if (firstHighlighted) {
        firstHighlighted.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}

function highlightRowUser(user) {
    console.log("highlightRow called with user:", user);

    document.querySelectorAll('table tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
    });

    document.querySelectorAll('#LogDetailTable tbody tr').forEach(tr => {
        const td = tr.querySelector('td:nth-child(5)');
        if (td) {
            const cellText = td.textContent.trim();
            if (cellText === user) {
                tr.classList.add('highlight');
            }
        }
    });

    const firstHighlighted = document.querySelector('#LogDetailTable tbody tr.highlight');
    if (firstHighlighted) {
        firstHighlighted.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}

function highlightRowTime(timeLabel) {
    console.log("highlightRow called with time:", timeLabel);

    const startTime = new Date(timeLabel.replace(" ", "T") + ":00");
    const endTime = new Date(startTime.getTime() + 3 * 60 * 60 * 1000); // +3시간

    document.querySelectorAll('table tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
    });

    document.querySelectorAll('#LogDetailTable tbody tr').forEach(tr => {
        const td = tr.querySelector('td:nth-child(4)');
        if (td) {
            const cellText = td.textContent.trim();
            const eventTime = new Date(cellText.replace(" ", "T"));
            if (eventTime >= startTime && eventTime < endTime) {
                tr.classList.add('highlight');
            }
        }
    });

    const firstHighlighted = document.querySelector('#LogDetailTable tbody tr.highlight');
    if (firstHighlighted) {
        firstHighlighted.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}

const logTypeCtx = document.getElementById('typeDonutChart').getContext('2d');
const logTypeChart = new Chart(logTypeCtx, {
    type: 'doughnut',
    data: {
        labels: ["T1059", "T1548", "T1548.003"],
        datasets: [{
            data: [1, 1, 51],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            },
            title: { 
                display: true,
                text: "Malicious Behavior By Type",
                font: { size: 16, weight: 'bold' }
            }
        },
        onClick: (evt) => {
            const points = logTypeChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const index = points[0].index;
                const label = logTypeChart.data.labels[index];
                console.log("Clicked label:", label);
                highlightRowType(label);
            }
        }
    },
    plugins: [ChartDataLabels]
});

const logUserCtx = document.getElementById('userBarChart').getContext('2d');
const logUserChart = new Chart(logUserCtx, {
    type: 'bar',
    data: {
            labels: ["", "yeji"],
            datasets: [{
            label: 'Event Count',
            data: [1, 52],
            backgroundColor: 'rgba(54,162,235,0.6)'
        }]
    },
    options: {
        indexAxis: 'y',
        responsive: false, 
        plugins: { 
            legend: { display: false },
            datalabels: {
                color: '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'right'
            },
            title: { 
                display: true,
                text: "Malicious Behavior by Username",
                font: { size: 16, weight: 'bold' } 
            }
        },
        onClick: (evt) => {
            const points = logUserChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const index = points[0].index;
                const label = logUserChart.data.labels[index];
                console.log("Clicked label:", label);
                highlightRowUser(label);
            }
        }
    },
    plugins: [ChartDataLabels]
});

const logTimeCtx = document.getElementById('timeHistogram').getContext('2d');
const logTimeChart = new Chart(logTimeCtx, {
    type: 'bar',
    data: {
        labels: ["2025-07-30 21:00", "2025-07-31 00:00", "2025-07-31 03:00", "2025-07-31 06:00", "2025-07-31 09:00", "2025-07-31 12:00", "2025-07-31 15:00", "2025-07-31 18:00", "2025-07-31 21:00"],
        datasets: [{
            label: 'Event Count',
            data: [7, 42, 0, 0, 0, 2, 0, 0, 2],
            backgroundColor: 'rgba(255,99,132,0.6)'
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { display: false },
            datalabels: {
                color: '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top'
            },
            title: {
                display: true,
                text: "Malicious Behavior By Time",
                font: { size: 16, weight: 'bold' }
            }
        },
        onClick: (evt) => {
            const points = logTimeChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const index = points[0].index;
                const label = logTimeChart.data.labels[index];
                console.log("Clicked label:", label);
                highlightRowTime(label);
            }
        },
        scales: {
            x: {
                title: {
                    display: false,
                    text: 'Time Interval (3 hours)'
                }
            },
            y: {
                beginAtZero: true,
                title: {
                    display: false,
                    text: 'Number of Events'
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

</body>
</html>

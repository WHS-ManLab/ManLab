<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ManLab Regular Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:target {
            background-color: #ffff99;
            transition : background-color 0.3s ease;
        }
        tr.highlight {
            background-color: #ffff99;
        }
        h1 {
            text-align: center;
        }
        canvas {
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
<h1 style="text-align: center;">ManLab Regular Security Report</h1>
<p style="text-align: right;">Report period: 2025-07-28 19:46:13 ~ 2025-07-29 19:46:13</p>

<hr/>
<h1>üìÇ File Integrity Monitoring Report</h1>

<h2>‚Ä¢ Modified Files (Manual Scan Results)</h2>
<div style="display: flex; justify-content: space-between; gap: 20px; flex-wrap: wrap;">
    <!-- ÌôïÏû•ÏûêÎ≥Ñ Ï∞®Ìä∏ + Î≤îÎ°Ä -->
    <div style="display: flex; align-items: center;">
        <canvas id="manualScanExtChart" width="400" height="400"></canvas>
        <div id="manualScanExtLegend" style="margin-left: 20px;"></div>
    </div>

    <!-- Î≥ÄÍ≤Ω ÏÇ¨Ïú†Î≥Ñ Ï∞®Ìä∏ -->
    <div>
        <canvas id="manualScanReasonChart" width="400" height="400"></canvas>
    </div>

    <!-- ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï∞®Ìä∏ -->
    <div>
        <canvas id="manualScanTimeChart" width="400" height="400"></canvas>
    </div>
</div>

<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Path</th>
            <th>Current MD5 Hash</th>
            <th>Permission</th>
            <th>UID</th>
            <th>GID</th>
            <th>CTime</th>
            <th>MTime</th>
            <th>Size</th>
        </tr>
    </thead>
    <tbody>
<tr><td>1</td><td>/etc/audit/rules.d/manlab.rules</td><td>876618cf387096c220dda9153a82674b</td><td>rw-r-----</td><td>0</td><td>0</td><td>2025-07-29 19:43:57</td><td>2025-07-29 19:43:57</td><td>1241</td></tr>
<tr><td>2</td><td>/etc/rsyslog.d/50-manlab.conf</td><td>82b0b46e3cda59358689540940a8940a</td><td>rw-r--r--</td><td>0</td><td>0</td><td>2025-07-29 19:43:50</td><td>2025-07-29 19:43:50</td><td>166</td></tr>
<tr><td>3</td><td>/etc/resolv.conf</td><td>e395a1bbd709da24301c66c4b8788973</td><td>rw-r--r--</td><td>101</td><td>103</td><td>2025-07-29 19:07:38</td><td>2025-07-29 19:07:38</td><td>728</td></tr>
<tr><td>4</td><td>/etc/mtab</td><td>e955750ba823b6cf3d1817ab1e4d5075</td><td>r--r--r--</td><td>0</td><td>0</td><td>2025-07-29 19:44:19</td><td>2025-07-29 19:44:19</td><td>0</td></tr>
<tr><td>5</td><td>/etc/systemd/system/multi-user.target.wants/manlab-init.service</td><td>ee4dc95e2db434c0ddf2f7e8e4884a72</td><td>rw-r--r--</td><td>0</td><td>0</td><td>2025-07-29 19:43:50</td><td>2025-07-29 19:43:50</td><td>190</td></tr>
<tr><td>6</td><td>/etc/systemd/system/manlab-init.service</td><td>ee4dc95e2db434c0ddf2f7e8e4884a72</td><td>rw-r--r--</td><td>0</td><td>0</td><td>2025-07-29 19:43:50</td><td>2025-07-29 19:43:50</td><td>190</td></tr>
<tr><td>7</td><td>/etc/cups/subscriptions.conf</td><td>93ee57c40ee01ffb2821e153f1e9e7cb</td><td>rw-r-----</td><td>0</td><td>7</td><td>2025-07-29 19:08:09</td><td>2025-07-29 19:08:09</td><td>975</td></tr>
<tr><td>8</td><td>/etc/cups/subscriptions.conf.O</td><td>2270eb295fbaa3ecaaf05efd45852e1e</td><td>rw-r-----</td><td>0</td><td>7</td><td>2025-07-29 19:08:09</td><td>2025-07-29 15:53:18</td><td>384</td></tr>
<tr><td>9</td><td>/etc/printcap</td><td>ebb5375075e20463db8dfa96763390af</td><td>rw-r--r--</td><td>0</td><td>0</td><td>2025-07-29 19:07:36</td><td>2025-07-29 19:07:36</td><td>135</td></tr>
</tbody></table>
<h2>‚Ä¢ Real-time Monitoring Events</h2>
<div style="display: flex; justify-content: space-between;">
    <canvas id="realtimeChart"     width="400" height="400"></canvas>
    <canvas id="realtimeTimeChart" width="400" height="400"></canvas>
</div>
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Path</th>
            <th>Event Type</th>
            <th>New Name</th>
            <th>Timestamp</th>
        </tr>
    </thead>
    <tbody>
<tr><td>1</td><td>/etc/p.txt</td><td>CREATE</td><td>-</td><td>2025-07-29 19:18:21.622</td></tr><tr><td>2</td><td>/etc/p.txt</td><td>CREATE</td><td>-</td><td>2025-07-29 19:18:21.622</td></tr></tbody></table>
<script>
const extCtx = document.getElementById('manualScanExtChart').getContext('2d');
const extChart = new Chart(extCtx, {
    type: 'doughnut',
    data: {
        labels: ["/etc/mtab", "/etc/printcap", "O", "conf", "rules", "service"],
        datasets: [{
            data: [1, 1, 1, 3, 1, 2],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            },
            title: {
                display: true,
                text: "File Extension",
                font: {size: 18, weight: 'bold' }
            }
        }
    },
    plugins: [ChartDataLabels] 
});

//ÎèÑÎÑõ ÏöîÏïΩ Ï∞®Ìä∏ Ìëú

(function() {
    const data = extChart.data;
    const total = data.datasets[0].data.reduce((sum, v) => sum + v, 0);
    let htmlLegend = '<table style="border-collapse: collapse; text-align: right;">';
    data.labels.forEach((label, i) => {
        const count = data.datasets[0].data[i];
        const pct   = ((count/total)*100).toFixed(2) + '%';
        const color = data.datasets[0].backgroundColor[i];
        htmlLegend += `
            <tr>
              <td style="padding:4px;">
                <span style="display:inline-block;width:12px;height:12px;
                          background-color:${color};margin-right:8px;"></span>
                ${label}
              </td>
              <td style="padding:4px;">${count}</td>
              <td style="padding:4px;">${pct}</td>
            </tr>`;
    });
    htmlLegend += '</table>';
    document.getElementById('manualScanExtLegend').innerHTML = htmlLegend;
})();

const reasonCtx = document.getElementById('manualScanReasonChart').getContext('2d');
new Chart(reasonCtx, {
    type: 'bar',
    data: {
        labels: ["CTime Î≥ÄÍ≤Ω", "MTime Î≥ÄÍ≤Ω", "ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω", "Ìï¥ÏãúÍ∞í Î≥ÄÍ≤Ω"],
        datasets: [{
            label: 'Î≥ÄÍ≤ΩÎêú ÌååÏùº Ïàò',
            data: [9, 9, 3, 4],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { display: false },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (value) => value
            },
            title: {
                display: true,
                text: "File Change Reasons",
                font: {size: 18, weight: 'bold' }
            }
        },
        scales: {
            y:{
                beginAtZero: true,
                ticks:{
                    stepSize: 1,
                    precision: 0
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});

const timeCtx = document.getElementById('manualScanTimeChart').getContext('2d');
    new Chart(timeCtx, {
        type: 'bar',
        data: {
            labels: ["2025-07-28 18:00", "2025-07-28 21:00", "2025-07-29 00:00", "2025-07-29 03:00", "2025-07-29 06:00", "2025-07-29 09:00", "2025-07-29 12:00", "2025-07-29 15:00", "2025-07-29 18:00"],
        datasets: [{
            label: 'Ïù¥Î≤§Ìä∏ Ïàò',
            data: [0, 0, 0, 0, 0, 0, 0, 1, 8],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)", "rgba(44, 224, 148, 0.6)", "rgba(94, 48, 2, 0.6)", "rgba(144, 128, 112, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: ' Modification By Time'
            },
            datalabels: {
                color: '#000',
                font: { size : 18, weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (v) => v
            }
        },
        scales: {
            x: {
                grid: { display: true, drawBorder: true },
                ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 }
            },
            y: {
                beginAtZero: true,
                grid: { display: true }
            }
        }
    },
    plugins: [ChartDataLabels]
});

const rtCtx = document.getElementById('realtimeChart').getContext('2d');
new Chart(rtCtx, {
    type: 'bar',
    data: {
        labels: ["CREATE"],
        datasets: [{
            label: 'Event Count',
            data: [2],
            backgroundColor: ["rgba(255, 99, 132, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            }
        },
        scales: {
            y:{
                beginAtZero: true,
                ticks:{
                    stepSize: 1,
                    precision: 0
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});

const rtTimeCtx = document.getElementById('realtimeTimeChart').getContext('2d');
new Chart(rtTimeCtx, {
    type: 'bar',
    data: {
        labels: ["2025-07-28 18:00", "2025-07-28 21:00", "2025-07-29 00:00", "2025-07-29 03:00", "2025-07-29 06:00", "2025-07-29 09:00", "2025-07-29 12:00", "2025-07-29 15:00", "2025-07-29 18:00"],
        datasets: [{
            label: 'Events By Time',
            data: [0, 0, 0, 0, 0, 0, 0, 0, 2],
            backgroundColor: ["rgba(255, 99, 132, 0.6)", "rgba(54, 162, 235, 0.6)", "rgba(255, 206, 86, 0.6)", "rgba(75, 192, 192, 0.6)", "rgba(153, 102, 255, 0.6)", "rgba(255, 159, 64, 0.6)", "rgba(44, 224, 148, 0.6)", "rgba(94, 48, 2, 0.6)", "rgba(144, 128, 112, 0.6)"
            ]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: 'Events by Time'
            },
            datalabels: {
                color: '#000',
                font: { weight: 'bold' },
                anchor: 'end',
                align: 'top',
                formatter: (value) => value
            }
        },
        scales: {
            x: {
                grid: { display: true, drawBorder: true },
                ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 }
            },
            y: {
                beginAtZero: true,
                grid: { display: true }
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

<hr/>
<h1>üîç Malware Scan Report</h1>
<h2>‚Ä¢ Malware Scan Detection Overview</h2>
<canvas id="malwareScanDonutChart" width="400" height="400"></canvas>

<h2>‚Ä¢ Scan Details</h2>
<table>
    <thead>
        <tr>
            <th>Date</th>
            <th>ID</th>
            <th>File Path</th>
            <th>File Name</th>
            <th>Reason</th>
            <th>Malware Name / Rule</th>
            <th>Quarantine Success Status</th>
        </tr>
    </thead>
    <tbody>
<tr>
            <td colspan="7" style="text-align: center; font-style: italic;">
            No quarantined files found during this period.
            </td>
        </tr>
    </tbody>
</table>

<script>
const scanCtx = document.getElementById('malwareScanDonutChart').getContext('2d');
new Chart(scanCtx, {
    type: 'doughnut',
    data: {
        labels: ['Detected', 'Not Detected'],
        datasets: [{
            data: [0, 0],
            backgroundColor: [
                'rgba(255, 99, 132, 0.6)', // Detected (Red)
                'rgba(75, 192, 192, 0.6)'  // Not Detected (Cyan)
            ]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

<hr/>
<h1>üìúMalicious Behavior Report</h1>

<h2>‚Ä¢ Detected Malicious Behavior Types Overview</h2>
<canvas id="typeDonutChart" width="400" height="400"></canvas>

<h2>‚Ä¢ Detected Malicious Behavior Details</h2>
<table id="LogDetailTable">
    <thead>
        <tr>
            <th>Event ID</th>
            <th>Type</th>
            <th>Description</th>
            <th>Timestamp</th>
            <th>Username</th>
            <th>Original Log Path</th>
        </tr>
    </thead>
    <tbody>
<tr><td><a href="#raw-1">1</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-28 22:13:34</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-2">2</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-28 22:14:05</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-3">3</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-28 22:56:28</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-4">4</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-28 22:56:51</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-5">5</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-28 23:05:33</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-6">6</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-28 23:05:39</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-7">7</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 16:41:03</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-8">8</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 17:03:23</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-9">9</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-29 18:00:02</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-10">10</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 18:00:27</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-11">11</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-29 19:15:30</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-12">12</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 19:15:54</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-13">13</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/touch /etc/p.txt</td><td>2025-07-29 19:18:21</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-14">14</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 19:18:28</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-15">15</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/local/bin/ManLab integscan</td><td>2025-07-29 19:44:16</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-16">16</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/mv /etc/t.txt /etc/o.txt</td><td>2025-07-29 19:45:21</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-17">17</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /etc/test.txt</td><td>2025-07-29 19:45:29</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
<tr><td><a href="#raw-18">18</a></td><td>T1548.003</td><td>ÎπÑÏù∏Í∞Ä ÏÇ¨Ïö©Ïûê yejiÍ∞Ä sudo Î™ÖÎ†π ÏÇ¨Ïö© : /usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td><td>2025-07-29 19:45:41</td><td>yeji</td><td>/var/log/manlab.log</td></tr>
</tbody>
</table>

<h2>Event Log Line by ID</h2>
<table>
    <thead>
        <tr>
            <th>Event ID</th>
            <th>Raw Log Line</th>
        </tr>
    </thead>
    <tbody>
<tr id="raw-1"><td>1</td><td>2025-07-28T22:13:34.243075+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-2"><td>2</td><td>2025-07-28T22:14:05.153091+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-3"><td>3</td><td>2025-07-28T22:56:28.223612+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-4"><td>4</td><td>2025-07-28T22:56:51.388396+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-5"><td>5</td><td>2025-07-28T23:05:33.325402+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-6"><td>6</td><td>2025-07-28T23:05:39.459423+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-7"><td>7</td><td>2025-07-29T16:41:03.407163+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-8"><td>8</td><td>2025-07-29T17:03:23.831775+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-9"><td>9</td><td>2025-07-29T18:00:02.280123+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-10"><td>10</td><td>2025-07-29T18:00:27.195437+09:00 ubuntu20 sudo:     yeji : TTY=pts/4 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-11"><td>11</td><td>2025-07-29T19:15:30.009258+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-12"><td>12</td><td>2025-07-29T19:15:54.979080+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-13"><td>13</td><td>2025-07-29T19:18:21.534547+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/touch /etc/p.txt</td></tr>
<tr id="raw-14"><td>14</td><td>2025-07-29T19:18:28.662016+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
<tr id="raw-15"><td>15</td><td>2025-07-29T19:44:16.941051+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/local/bin/ManLab integscan</td></tr>
<tr id="raw-16"><td>16</td><td>2025-07-29T19:45:21.814605+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/mv /etc/t.txt /etc/o.txt</td></tr>
<tr id="raw-17"><td>17</td><td>2025-07-29T19:45:29.864426+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /etc/test.txt</td></tr>
<tr id="raw-18"><td>18</td><td>2025-07-29T19:45:41.581240+09:00 ubuntu20 sudo:     yeji : TTY=pts/0 ; PWD=/home/yeji/manlab/ManLab ; USER=root ; COMMAND=/usr/bin/vi /root/ManLab/conf/ReportConfig.ini</td></tr>
</tbody>
</table>

<script>
function highlightRow(type) {
    console.log("highlightRow called with type:", type);

    document.querySelectorAll('table tbody tr').forEach(tr => {
        tr.classList.remove('highlight');
    });

    document.querySelectorAll('#LogDetailTable tbody tr').forEach(tr => {
        const td = tr.querySelector('td:nth-child(2)');
        if (td) {
            const cellText = td.textContent.trim();
            if (cellText === type) {
                tr.classList.add('highlight');
                tr.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
    });
}
const ctx = document.getElementById('typeDonutChart').getContext('2d');
const logTypeChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: ["T1548.003"],
        datasets: [{
            data: [18],
            backgroundColor: ["rgba(255, 99, 132, 0.6)"]
        }]
    },
    options: {
        responsive: false,
        plugins: {
            legend: { position: 'bottom' },
            datalabels: {
                color : '#000',
                font: { weight: 'bold' },
                formatter: (value) => value
            }
        },
        onClick: (evt) => {
            const points = logTypeChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (points.length > 0) {
                const index = points[0].index;
                const label = logTypeChart.data.labels[index];
                console.log("Clicked label:", label);
                highlightRow(label);
            }
        }
    },
    plugins: [ChartDataLabels]
});
</script>

</body>
</html>

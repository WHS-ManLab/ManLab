- type: T1546.016
  key: apt_exec
  description: proxychains 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "proxychains"
      match_type: contains
- type: T1546.016
  key: apt_exec
  description: netcat 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "netcat"
      match_type: contains
- type: T1546.016
  key: apt_exec
  description: nmap 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "nmap"
      match_type: contains
- type: T1546.016
  key: apt_exec
  description: tshark 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "tshark"
      match_type: contains
- type: T1546.016
  key: apt_exec
  description: wireshark 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "wireshark"
      match_type: contains
- type: T1546.016
  key: apt_exec
  description: openconnect 패키지 설치
  conditions:
    - field: exe
      value: "/usr/bin/apt"
      match_type: equals
    - field: "*"
      value: "install"
      match_type: contains
    - field: "*"
      value: "openconnect"
      match_type: contains
- type: T1053.003
  key: cron_exec
  description: "cron 작업 조회"
  conditions:
    - field: exe
      value: "/usr/bin/crontab"
      match_type: equals
    - field: "*"
      value: "-l"
      match_type: contains
- type: T1053.003
  key: cron_exec
  description: "cron 작업 편집"
  conditions:
    - field: exe
      value: "/usr/bin/crontab"
      match_type: equals
    - field: "*"
      value: "-e"
      match_type: contains
- type: T1053.003
  key: cron_exec
  description: "cron 작업 삭제"
  conditions:
    - field: exe
      value: /usr/bin/crontab
      match_type: equals
    - field: "*"
      value: "-r"
      match_type: contains
- type: T1053.003
  key: cron_daemon
  description: "cron 데몬 실행"
  conditions:
    - field: exe
      value: /usr/sbin/cron
      match_type: equals
- type: T1053.003
  key: cron_exec
  description: "root가 아닌 사용자의 crontab 명령어 실행"
  conditions:
    - field: exe
      value: "/usr/bin/crontab"
      match_type: equals
    - field: auid
      value: "0"
      match_type: notequals
- type: T1053.003
  key: cron_file_change
  description: "/etc/cron.d/ 디렉터리 내 파일 생성"
  conditions:
    - field: name
      value: "/etc/cron.d/"
      match_type: contains
    - field: syscall
      value: "257" 
      match_type: equals
- type: T1053.003
  key: cron_file_change
  description: "/etc/cron.d/ 디렉터리 내 파일 삭제"
  conditions:
    - field: name
      value: "/etc/cron.d/"
      match_type: equals
    - field: syscall
      value: "263" 
      match_type: equals
- type: T1053.003
  key: cron_file_change
  description: "cron.allow 파일 수정(cron 허용 사용자 변경)"
  conditions:
    - field: name
      value: "/etc/cron.allow"
      match_type: equals
    - field: syscall
      value: "257"
      match_type: equals
- type: T1136.001
  key: useradd_cmd
  description: "시스템 계정 생성"
  conditions:
    - field: comm
      value: useradd
      match_type: equals
    - field: "*"
      value: -r
      match_type: contains
- type: T1059
  key: tmp_exec
  description: "/tmp 디렉터리 내 파일 실행"
  conditions:
    - field: "*"
      value: "/tmp"
      match_type: contains
    - field: syscall
      value: "59"
      match_type: equals
- type: T1548.003
  key: sudoers_change
  description: "sudoers 설정 변경"
  conditions:
    - field: exe
      value: "/usr/sbin/visudo"
      match_type: equals
    - field: syscall
      value: "82"
      match_type: equals
- type: T1548
  key: setuid_exec
  description: "권한 상승 시도(실제 ID, 유효 ID 불일치)"
  conditions:
    - field: euid
      value: "0"
      match_type: equals
    - field: uid 
      value: "0"
      match_type: notequals
- type: T1548.003
  key: perm_changes
  description: "권한 상승 시도(setuid 비트 설정)"
  conditions:
    - field: exe
      value: "/usr/bin/chmod"
      match_type: equals
    - field: mode
      value: "47"
      match_type: contains
- type: T1548.003
  key: perm_changes
  description: "권한 상승 시도(setgid 비트 설정)"
  conditions:
    - field: exe
      value: "/usr/bin/chmod"
      match_type: equals
    - field: mode
      value: "27"
      match_type: contains
- type: T1548
  key: owner_changes
  description: "권한 상승 시도(파일 소유자 또는 그룹 변경)"
  conditions:
    - field: exe
      value: "/usr/bin/chown"
      match_type: equals
    - field: syscall
      value: "260"
      match_type: equals
- type: T1548
  key: owner_changes
  description: "권한 상승 시도(파일 소유자 또는 그룹 변경)"
  conditions:
    - field: exe
      value: "/usr/bin/chgrp"
      match_type: equals
    - field: syscall
      value: "260"
      match_type: equals
- type: T1052.001
  key: usb_file_access
  description: "이동식 저장장치 내 파일 복사"
  conditions:
    - field: exe
      value: "/usr/bin/cp"
      match_type: equals
    - field: "*"
      value: "/media/"
      match_type: contains
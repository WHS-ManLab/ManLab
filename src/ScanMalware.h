#ifndef SCANMALWARE_H
#define SCANMALWARE_H

#include <string>
#include <vector>
extern "C" {
    #include <yara.h>
}

struct DetectResult
{
    bool detected;
    std::string cause;
    std::string malwareName;
};

class ScanMalware
{
public:
    // 생성자
    ScanMalware(std::string dir, std::vector<std::string> exceptionDir, long long maxSize);

    // 실행
    void run();

    // 탐지된 악성코드 파일 경로 리스트 반환
    std::vector<std::string> getMalwareFiles() const;

private:
    // 검사할 루트 디렉토리
    std::string m_dir;

    // 예외 디렉토리 목록
    std::vector<std::string> m_exceptionDir;

    // 검사할 최대 파일 크기 (bytes 단위)
    long long m_maxSize;

    // 탐지된 악성코드 파일 경로 목록
    std::vector<std::string> m_malwareFiles;

    // 유틸 함수
    DetectResult detectByHash(const std::string& filePath);
    std::string computeHash(const std::string& filePath, const std::string& algo);
    std::string matchYaraRules(const std::string& filePath);
};

#endif // SCANMALWARE_H